{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "RagaSense Unified Metadata Schema",
  "description": "Unified schema for both Carnatic and Hindustani music metadata",
  "type": "object",
  "required": ["id", "tradition", "raga", "audio", "performance", "metadata"],
  "properties": {
    "id": {
      "type": "string",
      "description": "Unique identifier for this audio segment",
      "pattern": "^[a-z0-9_]+$"
    },
    "tradition": {
      "type": "string",
      "enum": ["carnatic", "hindustani"],
      "description": "Musical tradition classification"
    },
    "raga": {
      "type": "object",
      "required": ["name", "confidence", "verified"],
      "properties": {
        "name": {
          "type": "string",
          "description": "Primary raga name"
        },
        "tradition_specific_id": {
          "type": "string",
          "description": "Internal ID within the tradition (e.g., melakarta number)"
        },
        "confidence": {
          "type": "number",
          "minimum": 0,
          "maximum": 1,
          "description": "Confidence score for raga identification"
        },
        "verified": {
          "type": "boolean",
          "description": "Whether raga identification has been expert-verified"
        },
        "alternatives": {
          "type": "array",
          "items": {"type": "string"},
          "description": "Alternative possible raga names"
        },
        "melakarta_number": {
          "type": "integer",
          "minimum": 1,
          "maximum": 72,
          "description": "Melakarta number for Carnatic ragas"
        },
        "thaat": {
          "type": "string",
          "description": "Thaat classification for Hindustani ragas"
        },
        "arohana": {
          "type": "array",
          "items": {"type": "string"},
          "description": "Ascending scale notes"
        },
        "avarohana": {
          "type": "array", 
          "items": {"type": "string"},
          "description": "Descending scale notes"
        },
        "vadi": {
          "type": "string",
          "description": "Primary swara (king note)"
        },
        "samvadi": {
          "type": "string",
          "description": "Secondary swara (queen note)"
        },
        "time_of_day": {
          "type": "string",
          "enum": ["morning", "afternoon", "evening", "night"],
          "description": "Traditional time for raga performance"
        },
        "season": {
          "type": "string",
          "enum": ["spring", "summer", "monsoon", "autumn", "winter"],
          "description": "Seasonal association"
        },
        "mood": {
          "type": "array",
          "items": {
            "type": "string",
            "enum": ["devotional", "heroic", "peaceful", "romantic", "melancholic", "energetic", "mystical"]
          },
          "description": "Emotional characteristics"
        }
      }
    },
    "audio": {
      "type": "object",
      "required": ["file_path", "duration_seconds", "sample_rate", "format"],
      "properties": {
        "file_path": {
          "type": "string",
          "description": "Relative path to audio file"
        },
        "duration_seconds": {
          "type": "number",
          "minimum": 0,
          "description": "Duration in seconds"
        },
        "sample_rate": {
          "type": "integer",
          "description": "Audio sample rate in Hz"
        },
        "format": {
          "type": "string",
          "enum": ["wav", "mp3", "flac", "m4a"],
          "description": "Audio file format"
        },
        "bit_depth": {
          "type": "integer",
          "description": "Audio bit depth"
        },
        "channels": {
          "type": "integer",
          "minimum": 1,
          "description": "Number of audio channels"
        },
        "quality_score": {
          "type": "number",
          "minimum": 0,
          "maximum": 1,
          "description": "Audio quality assessment score"
        }
      }
    },
    "performance": {
      "type": "object",
      "required": ["artist", "instrument"],
      "properties": {
        "artist": {
          "type": "string",
          "description": "Primary performer name"
        },
        "artist_id": {
          "type": "string",
          "description": "Unique artist identifier"
        },
        "instrument": {
          "type": "string",
          "description": "Primary instrument"
        },
        "accompanying_instruments": {
          "type": "array",
          "items": {"type": "string"},
          "description": "List of accompanying instruments"
        },
        "recording_date": {
          "type": "string",
          "format": "date",
          "description": "Date of recording"
        },
        "performance_type": {
          "type": "string",
          "enum": ["concert", "practice", "teaching", "studio", "live"],
          "description": "Type of performance"
        },
        "venue": {
          "type": "string",
          "description": "Performance venue"
        },
        "tempo": {
          "type": "number",
          "description": "Tempo in BPM"
        }
      }
    },
    "composition": {
      "type": "object",
      "properties": {
        "title": {
          "type": "string",
          "description": "Composition title"
        },
        "composer": {
          "type": "string",
          "description": "Composer name"
        },
        "type": {
          "type": "string",
          "enum": ["kriti", "varnam", "thillana", "bandish", "khayal", "dhrupad", "tarana", "bhajan"],
          "description": "Type of composition"
        },
        "tala": {
          "type": "string",
          "description": "Rhythmic cycle"
        },
        "language": {
          "type": "string",
          "description": "Language of lyrics"
        },
        "lyrics": {
          "type": "string",
          "description": "Composition lyrics"
        }
      }
    },
    "segments": {
      "type": "array",
      "items": {
        "type": "object",
        "required": ["start_time", "end_time", "segment_type"],
        "properties": {
          "start_time": {
            "type": "number",
            "minimum": 0,
            "description": "Start time in seconds"
          },
          "end_time": {
            "type": "number",
            "minimum": 0,
            "description": "End time in seconds"
          },
          "segment_type": {
            "type": "string",
            "enum": ["exposition", "improvisation", "composition", "alap", "jod", "jhala", "gat", "tana"],
            "description": "Type of musical segment"
          },
          "raga_purity": {
            "type": "number",
            "minimum": 0,
            "maximum": 1,
            "description": "How purely the raga is rendered in this segment"
          },
          "notes": {
            "type": "string",
            "description": "Additional notes about the segment"
          }
        }
      }
    },
    "analysis": {
      "type": "object",
      "properties": {
        "pitch_analysis": {
          "type": "object",
          "properties": {
            "fundamental_frequency_range": {
              "type": "array",
              "items": {"type": "number"},
              "description": "Min and max fundamental frequency"
            },
            "pitch_accuracy": {
              "type": "number",
              "minimum": 0,
              "maximum": 1,
              "description": "Pitch accuracy score"
            }
          }
        },
        "rhythm_analysis": {
          "type": "object",
          "properties": {
            "tempo_stability": {
              "type": "number",
              "minimum": 0,
              "maximum": 1,
              "description": "How stable the tempo is"
            },
            "rhythmic_complexity": {
              "type": "number",
              "minimum": 0,
              "maximum": 1,
              "description": "Complexity of rhythmic patterns"
            }
          }
        },
        "melodic_analysis": {
          "type": "object",
          "properties": {
            "melodic_contour": {
              "type": "string",
              "description": "Description of melodic movement"
            },
            "ornamentation_density": {
              "type": "number",
              "minimum": 0,
              "maximum": 1,
              "description": "Density of gamakas/ornamentations"
            }
          }
        }
      }
    },
    "metadata": {
      "type": "object",
      "required": ["source", "license", "created_date"],
      "properties": {
        "source": {
          "type": "string",
          "description": "Original data source identifier"
        },
        "license": {
          "type": "string",
          "description": "License type for this data"
        },
        "contributor": {
          "type": "string",
          "description": "Contributor identifier"
        },
        "created_date": {
          "type": "string",
          "format": "date",
          "description": "Date when this record was created"
        },
        "last_updated": {
          "type": "string",
          "format": "date",
          "description": "Date when this record was last updated"
        },
        "version": {
          "type": "string",
          "description": "Version of this metadata record"
        },
        "quality_tier": {
          "type": "string",
          "enum": ["tier1", "tier2", "tier3"],
          "description": "Quality classification tier"
        }
      }
    }
  }
}
